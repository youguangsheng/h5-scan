import"./html5-qrcode-scanner-WlYy4vny.js";import{o as fe,a as W,i as Fe,w as _,b as Y,n as ve,c as me,u as Q,r as m,d as ye,g as Z,e as D,f as H,h as v,j as Ne,m as F,k as Le,T as ge,l as he,p as pe,v as be,q as Re,F as je,s as Me,_ as Ye,t as He,x as P,y as ee,z as Ue,A as Ve,B as Ke}from"./index-BzlQHrN1.js";const te=e=>{var t=new Date(e*1e3),n=[t.getFullYear(),("0"+(t.getMonth()+1)).slice(-2),("0"+t.getDate()).slice(-2),("0"+t.getHours()).slice(-2),("0"+t.getMinutes()).slice(-2),("0"+t.getSeconds()).slice(-2)];return n.slice(0,3).join("-")+" "+n.slice(3).join(":")};function Xe(){}const I=Object.assign,Ee=typeof window<"u",U=e=>e!==null&&typeof e=="object",O=e=>e!=null,X=e=>typeof e=="function",qe=e=>U(e)&&X(e.then)&&X(e.catch),Ce=e=>typeof e=="number"||/^\d+(\.\d+)?$/.test(e),We=()=>Ee?/ios|iphone|ipad|ipod/.test(navigator.userAgent.toLowerCase()):!1;function ne(e,t){const n=t.split(".");let o=e;return n.forEach(a=>{var s;o=U(o)&&(s=o[a])!=null?s:""}),o}function Ze(e,t,n){return t.reduce((o,a)=>(o[a]=e[a],o),{})}const M=null,h=[Number,String],B={type:Boolean,default:!0},Ge=e=>({type:Number,default:e}),E=e=>({type:String,default:e});var G=typeof window<"u";function we(e){let t;Y(()=>{e(),ve(()=>{t=!0})}),me(()=>{t&&e()})}function Se(e,t,n={}){if(!G)return;const{target:o=window,passive:a=!1,capture:s=!1}=n;let l=!1,c;const f=i=>{if(l)return;const d=Q(i);d&&!c&&(d.addEventListener(e,t,{capture:s,passive:a}),c=!0)},u=i=>{if(l)return;const d=Q(i);d&&c&&(d.removeEventListener(e,t,s),c=!1)};fe(()=>u(o)),W(()=>u(o)),we(()=>f(o));let r;return Fe(o)&&(r=_(o,(i,d)=>{u(d),f(i)})),()=>{r==null||r(),u(o),l=!0}}var L,K;function Je(){if(!L&&(L=m(0),K=m(0),G)){const e=()=>{L.value=window.innerWidth,K.value=window.innerHeight};e(),window.addEventListener("resize",e,{passive:!0}),window.addEventListener("orientationchange",e,{passive:!0})}return{width:L,height:K}}var Qe=/scroll|auto|overlay/i,et=G?window:void 0;function tt(e){return e.tagName!=="HTML"&&e.tagName!=="BODY"&&e.nodeType===1}function nt(e,t=et){let n=e;for(;n&&n!==t&&tt(n);){const{overflowY:o}=window.getComputedStyle(n);if(Qe.test(o))return n;n=n.parentNode}return t}We();const ot=e=>e.stopPropagation();function Oe(e,t){(typeof e.cancelable!="boolean"||e.cancelable)&&e.preventDefault(),ot(e)}Je();function p(e){if(O(e))return Ce(e)?`${e}px`:String(e)}function at(e){if(O(e)){if(Array.isArray(e))return{width:p(e[0]),height:p(e[1])};const t=p(e);return{width:t,height:t}}}function st(e){const t={};return e!==void 0&&(t.zIndex=+e),t}const ct=/-(\w)/g,Be=e=>e.replace(ct,(t,n)=>n.toUpperCase()),{hasOwnProperty:lt}=Object.prototype;function it(e,t,n){const o=t[n];O(o)&&(!lt.call(e,n)||!U(o)?e[n]=o:e[n]=_e(Object(e[n]),o))}function _e(e,t){return Object.keys(t).forEach(n=>{it(e,t,n)}),e}var ut={name:"姓名",tel:"电话",save:"保存",clear:"清空",cancel:"取消",confirm:"确认",delete:"删除",loading:"加载中...",noCoupon:"暂无优惠券",nameEmpty:"请填写姓名",addContact:"添加联系人",telInvalid:"请填写正确的电话",vanCalendar:{end:"结束",start:"开始",title:"日期选择",weekdays:["日","一","二","三","四","五","六"],monthTitle:(e,t)=>`${e}年${t}月`,rangePrompt:e=>`最多选择 ${e} 天`},vanCascader:{select:"请选择"},vanPagination:{prev:"上一页",next:"下一页"},vanPullRefresh:{pulling:"下拉即可刷新...",loosing:"释放即可刷新..."},vanSubmitBar:{label:"合计:"},vanCoupon:{unlimited:"无门槛",discount:e=>`${e}折`,condition:e=>`满${e}元可用`},vanCouponCell:{title:"优惠券",count:e=>`${e}张可用`},vanCouponList:{exchange:"兑换",close:"不使用",enable:"可用",disabled:"不可用",placeholder:"输入优惠码"},vanAddressEdit:{area:"地区",areaEmpty:"请选择地区",addressEmpty:"请填写详细地址",addressDetail:"详细地址",defaultAddress:"设为默认收货地址"},vanAddressList:{add:"新增地址"}};const oe=m("zh-CN"),ae=ye({"zh-CN":ut}),rt={messages(){return ae[oe.value]},use(e,t){oe.value=e,this.add({[e]:t})},add(e={}){_e(ae,e)}};var dt=rt;function ft(e){const t=Be(e)+".";return(n,...o)=>{const a=dt.messages(),s=ne(a,t+n)||ne(a,n);return X(s)?s(...o):s}}function q(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((n,o)=>n+q(e,o),""):Object.keys(t).reduce((n,o)=>n+(t[o]?q(e,o):""),""):""}function vt(e){return(t,n)=>(t&&typeof t!="string"&&(n=t,t=""),t=t?`${e}__${t}`:e,`${t}${q(t,n)}`)}function x(e){const t=`van-${e}`;return[t,vt(t),ft(t)]}const mt="van-haptics-feedback",se=5;function yt(e,{args:t=[],done:n,canceled:o,error:a}){if(e){const s=e.apply(null,t);qe(s)?s.then(l=>{l?n():o&&o()}).catch(a||Xe):s?n():o&&o()}else n()}function T(e){return e.install=t=>{const{name:n}=e;n&&(t.component(n,e),t.component(Be(`-${n}`),e))},e}const gt=Symbol();function Ie(e){const t=Z();t&&I(t.proxy,e)}const[ht,ce]=x("badge"),pt={dot:Boolean,max:h,tag:E("div"),color:String,offset:Array,content:h,showZero:B,position:E("top-right")};var bt=D({name:ht,props:pt,setup(e,{slots:t}){const n=()=>{if(t.content)return!0;const{content:c,showZero:f}=e;return O(c)&&c!==""&&(f||c!==0&&c!=="0")},o=()=>{const{dot:c,max:f,content:u}=e;if(!c&&n())return t.content?t.content():O(f)&&Ce(u)&&+u>+f?`${f}+`:u},a=c=>c.startsWith("-")?c.replace("-",""):`-${c}`,s=H(()=>{const c={background:e.color};if(e.offset){const[f,u]=e.offset,{position:r}=e,[i,d]=r.split("-");t.default?(typeof u=="number"?c[i]=p(i==="top"?u:-u):c[i]=i==="top"?p(u):a(u),typeof f=="number"?c[d]=p(d==="left"?f:-f):c[d]=d==="left"?p(f):a(f)):(c.marginTop=p(u),c.marginLeft=p(f))}return c}),l=()=>{if(n()||e.dot)return v("div",{class:ce([e.position,{dot:e.dot,fixed:!!t.default}]),style:s.value},[o()])};return()=>{if(t.default){const{tag:c}=e;return v(c,{class:ce("wrapper")},{default:()=>[t.default(),l()]})}return l()}}});const Et=T(bt);let Ct=2e3;const wt=()=>++Ct,[St,gn]=x("config-provider"),Ot=Symbol(St),[Bt,le]=x("icon"),_t=e=>e==null?void 0:e.includes("/"),It={dot:Boolean,tag:E("i"),name:String,size:h,badge:h,color:String,badgeProps:Object,classPrefix:String};var xt=D({name:Bt,props:It,setup(e,{slots:t}){const n=Ne(Ot,null),o=H(()=>e.classPrefix||(n==null?void 0:n.iconPrefix)||le());return()=>{const{tag:a,dot:s,name:l,size:c,badge:f,color:u}=e,r=_t(l);return v(Et,F({dot:s,tag:a,class:[o.value,r?"":`${o.value}-${l}`],style:{color:u,fontSize:p(c)},content:f},e.badgeProps),{default:()=>{var i;return[(i=t.default)==null?void 0:i.call(t),r&&v("img",{class:le("image"),src:l},null)]}})}}});const xe=T(xt),[Pt,z]=x("loading"),kt=Array(12).fill(null).map((e,t)=>v("i",{class:z("line",String(t+1))},null)),Dt=v("svg",{class:z("circular"),viewBox:"25 25 50 50"},[v("circle",{cx:"50",cy:"50",r:"20",fill:"none"},null)]),Tt={size:h,type:E("circular"),color:String,vertical:Boolean,textSize:h,textColor:String};var At=D({name:Pt,props:Tt,setup(e,{slots:t}){const n=H(()=>I({color:e.color},at(e.size))),o=()=>{const s=e.type==="spinner"?kt:Dt;return v("span",{class:z("spinner",e.type),style:n.value},[t.icon?t.icon():s])},a=()=>{var s;if(t.default)return v("span",{class:z("text"),style:{fontSize:p(e.textSize),color:(s=e.textColor)!=null?s:e.color}},[t.default()])};return()=>{const{type:s,vertical:l}=e;return v("div",{class:z([s,{vertical:l}]),"aria-live":"polite","aria-busy":!0},[o(),a()])}}});const $t=T(At),zt={show:Boolean,zIndex:h,overlay:B,duration:h,teleport:[String,Object],lockScroll:B,lazyRender:B,beforeClose:Function,overlayStyle:Object,overlayClass:M,transitionAppear:Boolean,closeOnClickOverlay:B};function Ft(e,t){return e>t?"horizontal":t>e?"vertical":""}function Nt(){const e=m(0),t=m(0),n=m(0),o=m(0),a=m(0),s=m(0),l=m(""),c=m(!0),f=()=>l.value==="vertical",u=()=>l.value==="horizontal",r=()=>{n.value=0,o.value=0,a.value=0,s.value=0,l.value="",c.value=!0};return{move:g=>{const b=g.touches[0];n.value=(b.clientX<0?0:b.clientX)-e.value,o.value=b.clientY-t.value,a.value=Math.abs(n.value),s.value=Math.abs(o.value);const C=10;(!l.value||a.value<C&&s.value<C)&&(l.value=Ft(a.value,s.value)),c.value&&(a.value>se||s.value>se)&&(c.value=!1)},start:g=>{r(),e.value=g.touches[0].clientX,t.value=g.touches[0].clientY},reset:r,startX:e,startY:t,deltaX:n,deltaY:o,offsetX:a,offsetY:s,direction:l,isVertical:f,isHorizontal:u,isTap:c}}let A=0;const ie="van-overflow-hidden";function Lt(e,t){const n=Nt(),o="01",a="10",s=r=>{n.move(r);const i=n.deltaY.value>0?a:o,d=nt(r.target,e.value),{scrollHeight:g,offsetHeight:b,scrollTop:C}=d;let w="11";C===0?w=b>=g?"00":"01":C+b>=g&&(w="10"),w!=="11"&&n.isVertical()&&!(parseInt(w,2)&parseInt(i,2))&&Oe(r)},l=()=>{document.addEventListener("touchstart",n.start),document.addEventListener("touchmove",s,{passive:!1}),A||document.body.classList.add(ie),A++},c=()=>{A&&(document.removeEventListener("touchstart",n.start),document.removeEventListener("touchmove",s),A--,A||document.body.classList.remove(ie))},f=()=>t()&&l(),u=()=>t()&&c();we(f),W(u),Le(u),_(t,r=>{r?l():c()})}function Pe(e){const t=m(!1);return _(e,n=>{n&&(t.value=n)},{immediate:!0}),n=>()=>t.value?n():null}const ue=()=>{var e;const{scopeId:t}=((e=Z())==null?void 0:e.vnode)||{};return t?{[t]:""}:null},[Rt,jt]=x("overlay"),Mt={show:Boolean,zIndex:h,duration:h,className:M,lockScroll:B,lazyRender:B,customStyle:Object,teleport:[String,Object]};var Yt=D({name:Rt,props:Mt,setup(e,{slots:t}){const n=m(),o=Pe(()=>e.show||!e.lazyRender),a=l=>{e.lockScroll&&Oe(l)},s=o(()=>{var l;const c=I(st(e.zIndex),e.customStyle);return O(e.duration)&&(c.animationDuration=`${e.duration}s`),pe(v("div",{ref:n,style:c,class:[jt(),e.className]},[(l=t.default)==null?void 0:l.call(t)]),[[be,e.show]])});return Se("touchmove",a,{target:n}),()=>{const l=v(ge,{name:"van-fade",appear:!0},{default:s});return e.teleport?v(he,{to:e.teleport},{default:()=>[l]}):l}}});const Ht=T(Yt),Ut=I({},zt,{round:Boolean,position:E("center"),closeIcon:E("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:E("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[Vt,re]=x("popup");var Kt=D({name:Vt,inheritAttrs:!1,props:Ut,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:n,slots:o}){let a,s;const l=m(),c=m(),f=Pe(()=>e.show||!e.lazyRender),u=H(()=>{const y={zIndex:l.value};if(O(e.duration)){const S=e.position==="center"?"animationDuration":"transitionDuration";y[S]=`${e.duration}s`}return y}),r=()=>{a||(a=!0,l.value=e.zIndex!==void 0?+e.zIndex:wt(),t("open"))},i=()=>{a&&yt(e.beforeClose,{done(){a=!1,t("close"),t("update:show",!1)}})},d=y=>{t("clickOverlay",y),e.closeOnClickOverlay&&i()},g=()=>{if(e.overlay)return v(Ht,F({show:e.show,class:e.overlayClass,zIndex:l.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},ue(),{onClick:d}),{default:o["overlay-content"]})},b=y=>{t("clickCloseIcon",y),i()},C=()=>{if(e.closeable)return v(xe,{role:"button",tabindex:0,name:e.closeIcon,class:[re("close-icon",e.closeIconPosition),mt],classPrefix:e.iconPrefix,onClick:b},null)};let w;const De=()=>{w&&clearTimeout(w),w=setTimeout(()=>{t("opened")})},Te=()=>t("closed"),Ae=y=>t("keydown",y),$e=f(()=>{var y;const{round:S,position:N,safeAreaInsetTop:V,safeAreaInsetBottom:ze}=e;return pe(v("div",F({ref:c,style:u.value,role:"dialog",tabindex:0,class:[re({round:S,[N]:N}),{"van-safe-area-top":V,"van-safe-area-bottom":ze}],onKeydown:Ae},n,ue()),[(y=o.default)==null?void 0:y.call(o),C()]),[[be,e.show]])}),J=()=>{const{position:y,transition:S,transitionAppear:N}=e,V=y==="center"?"van-fade":`van-popup-slide-${y}`;return v(ge,{name:S||V,appear:N,onAfterEnter:De,onAfterLeave:Te},{default:$e})};return _(()=>e.show,y=>{y&&!a&&(r(),n.tabindex===0&&ve(()=>{var S;(S=c.value)==null||S.focus()})),!y&&a&&(a=!1,t("close"))}),Ie({popupRef:c}),Lt(c,()=>e.show&&e.lockScroll),Se("popstate",()=>{e.closeOnPopstate&&(i(),s=!1)}),Y(()=>{e.show&&r()}),me(()=>{s&&(t("update:show",!0),s=!1)}),W(()=>{e.show&&e.teleport&&(i(),s=!0)}),Re(gt,()=>e.show),()=>e.teleport?v(he,{to:e.teleport},{default:()=>[g(),J()]}):v(je,null,[g(),J()])}});const Xt=T(Kt);let $=0;function qt(e){e?($||document.body.classList.add("van-toast--unclickable"),$++):$&&($--,$||document.body.classList.remove("van-toast--unclickable"))}const[Wt,k]=x("toast"),Zt=["show","overlay","teleport","transition","overlayClass","overlayStyle","closeOnClickOverlay","zIndex"],Gt={icon:String,show:Boolean,type:E("text"),overlay:Boolean,message:h,iconSize:h,duration:Ge(2e3),position:E("middle"),teleport:[String,Object],wordBreak:String,className:M,iconPrefix:String,transition:E("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:M,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean,zIndex:h};var ke=D({name:Wt,props:Gt,emits:["update:show"],setup(e,{emit:t,slots:n}){let o,a=!1;const s=()=>{const i=e.show&&e.forbidClick;a!==i&&(a=i,qt(a))},l=i=>t("update:show",i),c=()=>{e.closeOnClick&&l(!1)},f=()=>clearTimeout(o),u=()=>{const{icon:i,type:d,iconSize:g,iconPrefix:b,loadingType:C}=e;if(i||d==="success"||d==="fail")return v(xe,{name:i||d,size:g,class:k("icon"),classPrefix:b},null);if(d==="loading")return v($t,{class:k("loading"),size:g,type:C},null)},r=()=>{const{type:i,message:d}=e;if(n.message)return v("div",{class:k("text")},[n.message()]);if(O(d)&&d!=="")return i==="html"?v("div",{key:0,class:k("text"),innerHTML:String(d)},null):v("div",{class:k("text")},[d])};return _(()=>[e.show,e.forbidClick],s),_(()=>[e.show,e.type,e.message,e.duration],()=>{f(),e.show&&e.duration>0&&(o=setTimeout(()=>{l(!1)},e.duration))}),Y(s),fe(s),()=>v(Xt,F({class:[k([e.position,e.wordBreak==="normal"?"break-normal":e.wordBreak,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:c,onClosed:f,"onUpdate:show":l},Ze(e,Zt)),{default:()=>[u(),r()]})}});function Jt(){const e=ye({show:!1}),t=a=>{e.show=a},n=a=>{I(e,a,{transitionAppear:!0}),t(!0)},o=()=>t(!1);return Ie({open:n,close:o,toggle:t}),{open:n,close:o,state:e,toggle:t}}function Qt(e){const t=Me(e),n=document.createElement("div");return document.body.appendChild(n),{instance:t.mount(n),unmount(){t.unmount(),document.body.removeChild(n)}}}const en={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let R=[],tn=!1,de=I({},en);const nn=new Map;function on(e){return U(e)?e:{message:e}}function an(){const{instance:e,unmount:t}=Qt({setup(){const n=m(""),{open:o,state:a,close:s,toggle:l}=Jt(),c=()=>{},f=()=>v(ke,F(a,{onClosed:c,"onUpdate:show":l}),null);return _(n,u=>{a.message=u}),Z().render=f,{open:o,close:s,message:n}}});return e}function sn(){if(!R.length||tn){const e=an();R.push(e)}return R[R.length-1]}function j(e={}){if(!Ee)return{};const t=sn(),n=on(e);return t.open(I({},de,nn.get(n.type||de.type),n)),t}T(ke);const cn={class:"home"},ln={class:"content"},un=["disabled"],rn={class:"scan-tip"},dn={class:"teach"},fn=["disabled"],vn={__name:"HomeView",setup(e){const t=Ke(),n=Ue();Y(()=>{if(n.params){const{qr:u,err:r}=n.params.scanRes||{};u?(j(u),f(u)):r&&j(r)}document.title="VIP扫码登陆",c()});const o=()=>{t.push("/scan")},a=m(!1),s=m(),l=m(),c=()=>{const{odcode:u}=n.query||{};if(u){if(!u){j({type:"fail",message:"缺少odcode参数"});return}a.value=!0,fetch("/api/v1/scan_info",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({odcode:u})}).then(r=>r.json()).then(r=>{if(r.errcode===0){const{valid_until:i,count:d}=r.data;s.value=te(i),l.value=d}}).catch(r=>{console.error(r)}).finally(()=>{a.value=!1})}},f=u=>{const{odcode:r}=n.query||{};a.value=!1,fetch("/api/v1/scan_result",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({odcode:r,qrcode_content:u})}).then(i=>i.json()).then(i=>{if(i.errcode===0){const{valid_until:d,count:g}=i.data;s.value=te(d),l.value=g}setTimeout(()=>{j({type:"fail",message:i.errmsg})},1e3)}).catch(i=>{console.error(i)}).finally(()=>{a.value=!1})};return(u,r)=>(Ve(),He("div",cn,[P("div",ln,[P("button",{class:"scan-button button",disabled:a.value,onClick:o}," 扫描二维码 ",8,un),P("div",rn," 有效期 "+ee(s.value)+" 扫描次数剩余："+ee(l.value),1),P("div",dn,[r[0]||(r[0]=P("div",{class:"teach-title"},"首次登陆使用请先看教程",-1)),P("button",{class:"teach-button button",disabled:a.value}," 使用教程 ",8,fn)])])]))}},hn=Ye(vn,[["__scopeId","data-v-110b1ef7"]]);export{hn as default};
